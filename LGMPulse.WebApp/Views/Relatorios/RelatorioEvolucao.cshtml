@using LGMPulse.Domain.ViewModels
@model RelatEvolucaoViewModel;
@{
    Layout = null;
}

<style>
    :root {
        --chart-bg: #fafafa;
        --axis-color: rgba(0,0,0,.18);
        --line-receita: var(--pulse-green);
        --line-despesa: var(--pulse-red);
        --line-liquidez-pos: var(--btn-success-back);
        --line-liquidez-neg: var(--btn-danger-back);
        --point-radius: 4;
    }

    #relatorioEvolucao {
        display: grid;
        gap: 1rem;
        padding: 1rem 0;
        background: none;
    }

    .chart-block {
        padding: 0.7rem 1.2rem;
        border-radius: 14px;
        background: linear-gradient(145deg, var(--section-begin), var(--section-end));
    }

    .chart-title {
        font-size: 0.95rem;
        font-weight: 500;
        margin-bottom: .5rem;
        opacity: .75;
    }

    svg {
        width: 100%;
        height: 140px;
        overflow: visible;
    }

    .axis {
        stroke: var(--axis-color);
        stroke-width: 1;
    }

    .line {
        fill: none;
        stroke-width: 2.2;
    }

    .point {
        fill: revert-layer;
        stroke-width: 2;
    }

    .months {
        display: flex;
        justify-content: space-between;
        font-size: .7rem;
        opacity: .45;
        margin-top: .25rem;
        color: var(--grafite);
    }
</style>

<style>
    .chart-wrapper {
        position: relative;
    }

    .btnShowMore {
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 34px;
        background: linear-gradient( to right, rgba(255,255,255,0.78), rgba(255,255,255,0.72) );
        border: none;
        border-right: 1px solid var(--grid-lines);
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
        color: var(--cor-texto-card-header);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.2s ease, width 0.2s ease;
    }

        .btnShowMore:hover {
            background: linear-gradient( to right, rgba(255,255,255,0.84), rgba(255,255,255,0.80) );
            width: 42px;
        }

</style>


<div id="relatorioEvolucao">

    @await Html.PartialAsync("_GraficoReceitas", Model)
    @await Html.PartialAsync("_GraficoDespesas", Model)
    @await Html.PartialAsync("_GraficoLiquidez", Model)

</div>

<script>
    $(document).ready(function () {
        function ShowFreeModeMessage() {
            const titulo = "Mais contexto ao longo do tempo";
            const mens = `
                <p>
                    No <strong>Pulse gratuito</strong>, você acompanha a evolução recente:
                    o mês atual e os dois anteriores. É uma visão clara do curto prazo,
                    ideal para decisões do dia a dia.
                </p>
                <br>
                <p>
                    Na <strong>versão completa</strong>, o gráfico se amplia.
                    Além do mês atual, você visualiza os <strong>últimos seis meses</strong>,
                    identifica tendências, compara períodos e planeja com mais segurança.
                </p>
            `;
            ShowFreeModeModal(titulo, mens);
        }

        $(document).on("click", ".btnShowMore", function () {
            ShowFreeModeMessage();
        });


        localStorage.setItem('ultimoRelatorio', 'evolucao');
    });
</script>
